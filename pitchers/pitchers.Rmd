---
title: "Pitchers"
author: "Jason Scheer"
date: "2024-04-28"
output: pdf_document
---


```{r}
library(readr)
library(tidyverse)
library(dplyr)
hit = read_csv("hit.csv")
non_hit1 = read_csv("non_hit1.csv")
non_hit2 = read_csv("non_hit2.csv")
```






```{r}
library(shiny)

# UI
ui = navbarPage(
  title = "Switch Hitting Advantage or Disadvantage?",
  tabPanel(
    title = "Visualization",
    titlePanel(title = "Switch Hitting OBP Data 2017-2022"),
    sidebarLayout(
      sidebarPanel(
        selectInput(
          inputId = "batter",
          label = "Batter:",
          choices  = unique_batters,
          selected = "Ian Happ"),
      ),
      mainPanel(plotOutput("plot"))
    )
    
  ),
  tabPanel(title = "About", includeMarkdown("This Shiny App looks at players who have at least 100 PAs as a righty and as a lefty and compares their seasonal OBP to the league average OBP. The purpose of this is to see if being a switch hitter is actually beneifical for the hitter or if they might be better off just sticking to working on getting better at just one side of the plate. Unfortuantely I could only obtain this data from statcast so it is only from 2017-2022 seasons, so we can only see current and recently retired switch hitters. The data is setup where the bars are the OBP as a lefty and righty from 2017-2022 for everyone that had enough switch hitting PAs. The dashed line is the league average OBP for each season. There are a few players that will have just one stand in their graph because of not having enough plate appearances to make the threshold for both stands. Also I apologize for the double league average OBP above each year. I could only get it to show for each stand instead for each year."))
)

# Server
server = function(input, output) {
  
  
output$plot = renderPlot({
  filtered_obp = obp[obp$batter_name == input$batter, ]
  
  ggplot(data = filtered_obp, aes(x = game_year, y = OBP, fill = stand, color = stand)) +
    geom_bar(stat = "identity", position = "dodge") +
    geom_text(aes(label = round(OBP, 3)), position = position_dodge(width = 0.9), vjust = 1.2, size = 3, color = "black") +
    geom_line(aes(x = game_year, y = OBP_avg, group = 1), data = filtered_obp, color = "darkblue", linetype = "dashed") +
    geom_point(aes(x = game_year, y = OBP_avg), data = filtered_obp, color = "darkblue", size = 2) +  
    geom_text(aes(label = round(OBP_avg, 3)), data = filtered_obp, vjust = -0.3, size = 3, color = "darkblue", nudge_y = 0.03) +
    scale_y_continuous(labels = function(x) round(x, 3)) +  
    labs(x = "Year", y = "OBP", fill = "Stand", color = "Stand") +
    theme_bw()
})

}

# Run the application 
shinyApp(ui = ui, server = server)
```



